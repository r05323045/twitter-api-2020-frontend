(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ffa47a6"],{"5c7b":function(e,t,a){},a317:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-main"},[a("Navbar"),a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[e._v("推文清單")]),a("div",{staticClass:"tweet-list"},e._l(e.tweets,(function(t,n){return a("div",{key:t.id,staticClass:"list-item",class:{first:0===n}},[a("div",{staticClass:"icon cross",on:{click:function(a){return e.deleteTweet(t.id)}}}),a("div",{staticClass:"avatar",style:{background:"url("+t.avatar+") no-repeat center/cover"}}),a("div",{staticClass:"tweet-wrapper"},[a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[e._v(e._s(t.name))]),a("div",{staticClass:"account-and-post-time"},[e._v(e._s(t.account)+" • "+e._s(e._f("fromNow")(t.createdAt)))])]),a("div",{staticClass:"content"},[e._v(e._s(t.description))])])])})),0)])],1)},r=[],s=(a("a4d3"),a("e01a"),a("4de4"),a("d81d"),a("fb6a"),a("b0c0"),a("96cf"),a("1da1")),c=a("5530"),i=a("d178"),o=a("be6c"),u=a("2fa3"),d=a("2f62"),l={name:"AdminMain",components:{Navbar:i["a"]},data:function(){return{tweets:[]}},created:function(){this.fetchTweets()},computed:Object(c["a"])({},Object(d["b"])(["currentUser","isAuthenticated"])),methods:{fetchTweets:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$loading.show({isFullPage:!0,opacity:1},{default:e.$createElement("MyLoading")}),t.prev=1,t.next=4,o["a"].getTweets();case 4:n=t.sent,r=n.data,e.tweets=r.map((function(e){return{id:e.id,userId:e.User.id,name:e.User.name,avatar:e.User.avatar,account:e.User.account,createdAt:e.createdAt,description:e.description.slice(0,50)}})),e.tweets.sort((function(e,t){return e.createdAt<t.createdAt?1:-1})),a.hide(),t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](1),a.hide(),console.log(t.t0),u["a"].fire({icon:"error",title:"目前無法取得推文，請稍候"});case 16:case"end":return t.stop()}}),t,null,[[1,11]])})))()},deleteTweet:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o["a"].deleteTweet({tweetId:e});case 3:if(n=a.sent,r=n.data,"success"===r.status){a.next=7;break}throw new Error(r.message);case 7:t.tweets=t.tweets.filter((function(t){return t.id!==e})),u["a"].fire({icon:"success",title:"已成功刪除推文"}),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),console.log(a.t0),u["a"].fire({icon:"error",title:"無法刪除推文，請稍後再試"});case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},f=l,v=(a("dc7e"),a("2877")),w=Object(v["a"])(f,n,r,!1,null,null,null);t["default"]=w.exports},be6c:function(e,t,a){"use strict";var n=a("2fa3"),r=function(){return localStorage.getItem("token")};t["a"]={getTweets:function(){return n["b"].get("/admin/tweets",{headers:{Authorization:"Bearer ".concat(r())}})},deleteTweet:function(e){var t=e.tweetId;return n["b"].delete("/admin/tweets/".concat(t),{headers:{Authorization:"Bearer ".concat(r())}})},getUsers:function(){return n["b"].get("/admin/users",{headers:{Authorization:"Bearer ".concat(r())}})},signIn:function(e){var t=e.email,a=e.password;return n["b"].post("/admin/signin",{email:t,password:a})}}},d81d:function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").map,s=a("1dde"),c=a("ae40"),i=s("map"),o=c("map");n({target:"Array",proto:!0,forced:!i||!o},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},dc7e:function(e,t,a){"use strict";a("5c7b")}}]);
//# sourceMappingURL=chunk-1ffa47a6.490c7ba6.js.map